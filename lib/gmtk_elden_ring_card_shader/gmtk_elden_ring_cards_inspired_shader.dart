import 'dart:convert';
import 'dart:typed_data';

import 'dart:ui';

import 'package:umbra_flutter/umbra_flutter.dart';

/// {@template gmtk_elden_ring_cards_inspired_shader}
/// A Dart Shader class for the `gmtk_elden_ring_cards_inspired_shader` shader.
/// {@endtemplate}
class GmtkEldenRingCardsInspiredShader extends UmbraShader {
  GmtkEldenRingCardsInspiredShader._() : super(_cachedProgram!);

  /// {@macro gmtk_elden_ring_cards_inspired_shader}
  static Future<GmtkEldenRingCardsInspiredShader> compile() async {
    try {
      // Caching the program on the first compile call.
      _cachedProgram ??= await FragmentProgram.compile(
        spirv: Uint8List.fromList(base64Decode(_spirv)).buffer,
      );

      return GmtkEldenRingCardsInspiredShader._();
    } on Exception catch (err, stackTrace) {
      throw UmbraException(err, stackTrace);
    }
  }

  static FragmentProgram? _cachedProgram;

  Shader shader({
    required Size resolution,
    required Vector2 uResolution,
    required Image image,
  }) {
    return program.shader(
      floatUniforms: Float32List.fromList([
        uResolution.x,
        uResolution.y,
        resolution.width,
        resolution.height,
      ]),
      samplerUniforms: [
        ImageShader(
          image,
          TileMode.clamp,
          TileMode.clamp,
          UmbraShader.identity,
        ),
      ],
    );
  }
}

const _spirv =
    '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';
